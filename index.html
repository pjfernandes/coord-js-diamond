<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta property="og:image"
    content="https://pjfernandes.github.io/coordinates-js/logo.png">
  <meta name="description" content="Rafaela Guedes - Coordenadas">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css">
  <script src='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css' rel='stylesheet' />
  <link rel="stylesheet" href="css/style.css">
  <title>Encontre as coordenadas!</title>
</head>
<body>
  <div class="container">
    <div class="row justify-content-center">
      <div class="mt-2 col-12 col-lg-8">
        <div class="logo text-center mt-2">
          <img src="logo.png" alt="logo" class="w-50">
        </div>

        <div class="form text-center">
          <form>
            <div class="form-group mt-3">
              <input type="address" class="form-control form-control-lg" id="exampleInputAddress" placeholder="Digite o endereço">
            </div>
            <button type="submit" class="btn btn-primary">Encontrar</button>
          </form>
        </div>

        <div class="results">
          <p class="text-center mt-4"></p>
        </div>

        <div class="text-center">
          <div style="height: 200px">
            <div id="map" style="height: 200px"></div>
          </div>
        </div>


        <div class="footer">
          <div class="footer-links">
            <a href="https://instagram.com/rafaguedesjoias"><i class="fab fa-instagram"></i></a>
            <a href="https://www.linkedin.com/in/rafaela-guedes-35361732/"><i class="fab fa-linkedin"></i></a>
          </div>
          <div class="footer-copyright">Rafaela Guedes <i class="far fa-copyright"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoicGpmZXJuYW5kZXMiLCJhIjoiY2t1c291Z3lzNWg2bzJvbW5kNWNhbnZhaCJ9.eYxvagOUGuS5qDo-zOfRCA';

    const coords = ((place) => {
      const token = 'pk.eyJ1IjoicGpmZXJuYW5kZXMiLCJhIjoiY2t1c291Z3lzNWg2bzJvbW5kNWNhbnZhaCJ9.eYxvagOUGuS5qDo-zOfRCA';
      const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${place}.json?access_token=${token}`;
      fetch(url)
        .then(response => response.json())
        .then((data) => {
          const results = document.querySelector("p");
          if (data.features.length > 0) {
            const coordsArray = data.features[0].geometry.coordinates;
            results.innerHTML = `<p><i class="fas fa-map-marker-alt text-primary"></i> <strong>Lat:</strong> ${coordsArray[1]} - <strong>Long:</strong> ${coordsArray[0]}</p>`;
            const map = new mapboxgl.Map({
              container: 'map',
              style: 'mapbox://styles/pdunleav/cjofefl7u3j3e2sp0ylex3cyb',
              center: [coordsArray[0], coordsArray[1]],
              zoom: 12
            });
            const mapDiv = document.getElementById("map");
            mapDiv.insertAdjacentHTML('beforeend', map);
            new mapboxgl.Marker()
              .setLngLat([coordsArray[0], coordsArray[1]])
              .addTo(map);
          } else {
            results.innerHTML = `<p><h3><i class="far fa-frown text-primary"></h3></i> Local não encontrado</p>`;
          };
        });
    });

    const btn = document.querySelector(".btn");
    btn.addEventListener('click', (event) => {
      event.preventDefault();
      const placeText = document.querySelector(".form-control").value;
      coords(placeText);
    });
  </script>
</body>
</html>
